<?xml version="1.0" encoding="UTF-8"?>
<odoo>
    <record id="crm_lead_view_form_contact_fields" model="ir.ui.view">
        <field name="name">crm.lead.view.form.contact.fields</field>
        <field name="model">crm.lead</field>
        <field name="inherit_id" ref="crm.crm_lead_view_form"/>
        <field name="arch" type="xml">
            <!-- Make the contact fields more visible in the opportunity form -->
            <xpath expr="//sheet/div[@class='oe_title']" position="before">
                <field name="display_name" invisible="1"/>
            </xpath>
            
            <!-- Reorganize the partner section for better visibility -->
            <xpath expr="//group[@name='lead_info']" position="replace">
                <group name="lead_info">
                    <field name="partner_id" string="Customer" widget="res_partner_many2one"/>
                    <field name="contact_name" string="Contact Name" placeholder="e.g. John Smith"/>
                    <field name="title" placeholder="e.g. Mr." attrs="{'invisible': [('partner_id', '!=', False)]}"/>
                    <field name="function" placeholder="e.g. Sales Director" attrs="{'invisible': [('partner_id', '!=', False)]}"/>
                    <label for="email_from" attrs="{'invisible': [('partner_id', '!=', False)]}"/>
                    <div attrs="{'invisible': [('partner_id', '!=', False)]}">
                        <field name="email_from" widget="email"/>
                    </div>
                    <field name="phone" widget="phone" options="{'enable_sms': true}"/>
                    <field name="mobile" widget="phone" options="{'enable_sms': true}"/>
                </group>
            </xpath>
            
            <!-- Ensure proper organization for opportunity partner section -->
            <xpath expr="//group[@name='opportunity_partner']" position="replace">
                <group name="opportunity_partner">
                    <field name="partner_id" string="Customer" widget="res_partner_many2one"/>
                    <field name="email_from" string="Email" widget="email"/>
                    <field name="phone" widget="phone" options="{'enable_sms': true}"/>
                    <field name="mobile" widget="phone" options="{'enable_sms': true}"/>
                </group>
            </xpath>
        </field>
    </record>
</odoo>
